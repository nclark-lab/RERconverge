names(mamTrees)
knitr::opts_chunk$set(echo = TRUE)
#library("RERconverge")
mamTrees=readTrees("../data/mammal_62_aa_sub.tre", max.read = 100)
#This is a temporary alternative to using library in the next code block.
source('../R/enrichmentFuncs.R')
source('../R/plottingFuncs.R')
source('../R/projection_coevo.R')
source('../R/RERfuncs.R')
#library("RERconverge")
mamTrees=readTrees("../data/mammal_62_aa_sub.tre", max.read = 100)
names(mamTrees)
plot(mamTrees$masterTree)
head(names(mamTrees$trees))
plot(mamTrees$ABCA1)
plot(mamTrees$trees$ABCA1)
knitr::opts_chunk$set(echo = TRUE)
#library("RERconverge")
mamTrees=readTrees("../data/mammal_62_aa_meredplus_wCM.trees", max.read = 100)
#This is a temporary alternative to using library in the next code block.
source('../R/enrichmentFuncs.R')
source('../R/plottingFuncs.R')
source('../R/projection_coevo.R')
source('../R/RERfuncs.R')
#library("RERconverge")
mamTrees=readTrees("../data/mammal_62_aa_meredplus_wCM.trees", max.read = 100)
#library("RERconverge")
mamTrees=readTrees("../data/mammal62aa_meredplus_wCM.trees", max.read = 100)
#library("RERconverge")
mamTrees=readTrees("../data/mammal62aa_meredplus_wCM.trees", max.read = 200)
head(names(mamTrees))
tail(names(mamTrees$trees))
plot(mamTrees$trees$BEND3)
tb3 <- root(mamTrees$trees$BEND3)
tb3 <- root(mamTrees$trees$BEND3,outgroup=c("Wallaby","Tasmanian devil","Opossum"))
tb3 <- root(mamTrees$trees$BEND3,by=c("Wallaby","Tasmanian devil","Opossum"))
tb3 <- root(mamTrees$trees$BEND3,outgroup=c("Wallaby","Tasmanian_devil","Opossum"))
plot(tb3)
mamRER=getAllResiduals(mamTrees,useSpecies=mamTrees$masterTree$tip.label, transform = "none", weighted = F, cutoff=0.001)
mamRERs=scale(mamRER)
plot(mamTrees$masterTree)
masterrooted <- rood(mamTrees$masterTree,outgroup=c("Platypus","Wallaby","Tasmanian devil","Opossum"))
masterrooted <- root(mamTrees$masterTree,outgroup=c("Platypus","Wallaby","Tasmanian devil","Opossum"))
masterrooted <- root(mamTrees$masterTree,outgroup=c("Platypus","Wallaby","Tasmanian_devil","Opossum"))
tb3 <- root(mamTrees$trees$BEND3,outgroup=c("Wallaby","Tasmanian_devil","Opossum"))
par(mfrow=c(1,3))
plot(masterrooted) #plot average tree
plot(tb3) #plot individual gene tree
plotRers(mamRERs,"BEND3") #plot RERs
masterrooted <- root(mamTrees$masterTree,outgroup=c("Platypus","Wallaby","Tasmanian_devil","Opossum"))
tb3 <- root(mamTrees$trees$BEND3,outgroup=c("Wallaby","Tasmanian_devil","Opossum"))
par(mfrow=c(1,3))
plot(masterrooted) #plot average tree
plot(tb3) #plot individual gene tree
plotRers(mamRERs,"BEND3") #plot RERs
tb3 <- root(mamTrees$trees$BEND3,outgroup=c("Wallaby","Tasmanian_devil","Opossum"))
mamRER=getAllResiduals(mamTrees,useSpecies=mamTrees$masterTree$tip.label, transform = "none", weighted = F, cutoff=0.001)
masterrooted <- root(mamTrees$masterTree,outgroup=c("Platypus","Wallaby","Tasmanian_devil","Opossum"))
tb3 <- root(mamTrees$trees$BEND3,outgroup=c("Wallaby","Tasmanian_devil","Opossum"))
par(mfrow=c(1,3))
plot(masterrooted) #plot average tree
plot(tb3) #plot individual gene tree
plotRers(mamRERs,"BEND3") #plot RERs
masterrooted <- root(mamTrees$masterTree,outgroup=c("Platypus","Wallaby","Tasmanian_devil","Opossum"))
tb3 <- root(mamTrees$trees$BEND3,outgroup=c("Wallaby","Tasmanian_devil","Opossum"))
library(gridBase)
par(mfrow=c(1,3))
plot(masterrooted) #plot average tree
plot(tb3) #plot individual gene tree
plot.new()
vps <- baseViewports()
pushViewport(vps$figure)
tb3$tip.label
head(tb3$edge)
wsp <- tb3$tip.label[tb3$edge[,2]]
which(wsp=="Rat")
which(wsp=="Squirrel")
tb3$edge[48,]
tb3$tip.label[39]
masterrooted <- root(mamTrees$masterTree,outgroup=c("Platypus","Wallaby","Tasmanian_devil","Opossum"))
wspmr <- masterrooted$tip.label[masterrooted$edge[,2]]
wmrat <- which(wspmr=="Rat")
wmsquirrel <- which(wspmr=="Squirrel")
colMaster <- c(rep("black",length(masterrooted$edge)))
colMaster[wmrat] <- "red"
colMaster[wmsquirrel] <- "blue"
tb3 <- root(mamTrees$trees$BEND3,outgroup=c("Wallaby","Tasmanian_devil","Opossum"))
library(gridBase)
par(mfrow=c(1,2))
plot(masterrooted, main = "Average tree",col=colMaster) #plot average tree
plot(tb3, main = "BEND3 tree") #plot individual gene tree
par(mfrow=c(1,1))
plotRers(mamRERs,"BEND3") #plot RERs
plotRers(mamRERs,"BEND3") #plot RERs
names(mamRERs)
head(mamRERs)
mamRER$Rat
mamRER["Rat"]
#This is a temporary alternative to using library in the next code block.
source('../R/enrichmentFuncs.R')
source('../R/plottingFuncs.R')
source('../R/projection_coevo.R')
source('../R/RERfuncs.R')
source('../R/coordsfn.R')
selectforegroundbranches(mamTrees$masterTree)
marineb=read.tree("../data/MarineTreeBin.txt")
plot(marineb)
plot(marineb)
ls()
marineb2=selectforegroundbranches(mamTrees$masterTree)
write.tree(marineb2,'../data/MarineTreeBinCommonNames.txt')
plot(trees$ANO2)
plot(mamTrees$ANO2)
plot(mamTrees$trees$ANO2)
marineextantforeground = c("Walrus","Seal","Whale","Dolphin","Manatee")
wmarine <- which(wspmr %in% marineextantforeground)
marineb3rooted <- masterrooted
marineb3rooted$edge.lengths <- 0
marineb3rooted$edge.lengths[wmarine] <- 1
plot(marineb3rooted)
marineb3rooted$edge.lengths
marineb3rooted$edge.lengths
marineextantforeground = c("Walrus","Seal","Whale","Dolphin","Manatee")
wmarine <- which(wspmr %in% marineextantforeground)
marineb3rooted <- masterrooted
marineb3rooted$edge.lengths <- c(rep(0,length(marineb3rooted$edge.lengths)))
marineb3rooted$edge.lengths[wmarine] <- 1
plot(marineb3rooted)
marineb3rooted <- masterrooted
marineb3rooted$edge.lengths <- c(rep(0,length(marineb3rooted$edge.lengths)))
marineb3rooted$edge.lengths
length(marineb3rooted$edge.lengths)
length(masterrooted$edge.lengths)
class(corMarineLogWs)
corMarineLogWs=getAllCor(mamRERlogWs, phenvMarine)
phenvMarine=tree2Paths(marineb, mamTrees)
plot(marineb)
marineb=read.tree("../data/MarineTreeBinCommonNames.txt")
marinebrooted = root(marineb,outgroup=c("Platypus", "Wallaby","Tasmanian_devil","Opossum"))
plot(marinebrooted)
phenvMarine=tree2Paths(marineb, mamTrees)
phenvMarine2=foreground2Paths(marineextantforeground, mamTrees)
corMarineLogWs=getAllCor(mamRERlogWs, phenvMarine)
mamRERlogWs=scale(mamRERlogW)
mamRERlogW=getAllResiduals(mamTrees,useSpecies=mamTrees$masterTree$tip.label, transform = "log", weighted = T, cutoff=0.001)
mamRERlogWs=scale(mamRERlogW)
corMarineLogWs=getAllCor(mamRERlogWs, phenvMarine)
class(corMarineLogWs)
names(corMarineLogWs)
head(corMarineLogWs)
head(corMarineLogWs[order(corMarineLogWs$P),])
plot(trees$ANO2)
plot(mamTrees$trees$ANO2)
plot(mamTrees$trees$AK124326)
plot(mamTrees$trees$ANO2)
plot(mamTrees$trees$BMP10)
plot(mamTrees$trees$ANO2)
ano2rooted <- root(mamTrees$trees$ANO2,outgroup=c("Tasmanian_devil","Opossum"))
#Plot trees or RERs for these two genes. Helpful to highlight marine species (how to include Whale-Dolphin ancestor branch in rooted tree plot?)
ano2rooted <- root(mamTrees$trees$ANO2,outgroup=c("Tasmanian_devil","Opossum"))
bmp10rooted <- root(mamTrees$trees$BMP10,outgroup=c("Wallaby","Tasmanian_devil","Opossum"))
par(mfrow=c(1,2))
plot(ano2rooted, main = "ANO2 tree", cex=0.8)
plot(bmp10rooted, main = "BMP10 tree", cex=0.8)
par(mfrow=c(1,1))
names(mamRERlogW)
dim(mamRERlogW)
mamRERlogW[1:5,1:5]
mamRERlogW=getAllResiduals(mamTrees,useSpecies=mamTrees$masterTree$tip.label, transform = "log", weighted = T, cutoff=0.001)
marineb=read.tree("../data/MarineTreeBinCommonNames.txt")
marinebrooted = root(marineb,outgroup=c("Platypus", "Wallaby","Tasmanian_devil","Opossum"))
plot(marinebrooted, cex=0.8)
masterrooted <- root(mamTrees$masterTree,outgroup=c("Platypus","Wallaby","Tasmanian_devil","Opossum"))
wspmr <- masterrooted$tip.label[masterrooted$edge[,2]]
wmvole <- which(wspmr=="Vole")
wmsquirrel <- which(wspmr=="Squirrel")
colMaster <- c(rep("black",length(masterrooted$edge)))
colMaster[wmvole] <- "blue"
colMaster[wmsquirrel] <- "red"
tb3 <- root(mamTrees$trees$BEND3,outgroup=c("Wallaby","Tasmanian_devil","Opossum"))
wspbr <- tb3$tip.label[tb3$edge[,2]]
wbvole <- which(wspbr=="Vole")
wbsquirrel <- which(wspbr=="Squirrel")
coltb3 <- c(rep("black",length(tb3$edge)))
coltb3[wbvole] <- "blue"
coltb3[wbsquirrel] <- "red"
par(mfrow=c(1,2))
plot(masterrooted, main = "Average tree", edge.col=colMaster, cex=0.8) #plot average tree
plot(tb3, main = "BEND3 tree",edge.col=coltb3, cex=0.8) #plot individual gene tree
par(mfrow=c(1,1))
#Note: The RER plotting function currently bugs out when knitting the markdown, though it works perfectly fine in the console (try it!). I'm looking into this.
plotRers(mamRERs,"BEND3") #plot RERs
knitr::opts_chunk$set(echo = TRUE)
#This is a temporary alternative to using library in the next code block.
source('../R/enrichmentFuncs.R')
source('../R/plottingFuncs.R')
source('../R/projection_coevo.R')
source('../R/RERfuncs.R')
source('../R/coordsfn.R')
#library("RERconverge")
mamTrees=readTrees("../data/mammal62aa_meredplus_wCM.trees", max.read = 200)
mamRERlogW=getAllResiduals(mamTrees,useSpecies=mamTrees$masterTree$tip.label, transform = "log", weighted = T, cutoff=0.001)
mamRERlogWs=scale(mamRERlogW)
mamRERlogWs=scale(mamRERlogW)
masterrooted <- root(mamTrees$masterTree,outgroup=c("Platypus","Wallaby","Tasmanian_devil","Opossum"))
wspmr <- masterrooted$tip.label[masterrooted$edge[,2]]
wmvole <- which(wspmr=="Vole")
wmsquirrel <- which(wspmr=="Squirrel")
colMaster <- c(rep("black",length(masterrooted$edge)))
colMaster[wmvole] <- "blue"
colMaster[wmsquirrel] <- "red"
tb3 <- root(mamTrees$trees$BEND3,outgroup=c("Wallaby","Tasmanian_devil","Opossum"))
wspbr <- tb3$tip.label[tb3$edge[,2]]
wbvole <- which(wspbr=="Vole")
wbsquirrel <- which(wspbr=="Squirrel")
coltb3 <- c(rep("black",length(tb3$edge)))
coltb3[wbvole] <- "blue"
coltb3[wbsquirrel] <- "red"
par(mfrow=c(1,2))
plot(masterrooted, main = "Average tree", edge.col=colMaster, cex=0.8) #plot average tree
plot(tb3, main = "BEND3 tree",edge.col=coltb3, cex=0.8) #plot individual gene tree
par(mfrow=c(1,1))
#Note: The RER plotting function currently bugs out when knitting the markdown, though it works perfectly fine in the console (try it!). I'm looking into this.
plotRers(mamRERs,"BEND3") #plot RERs
masterrooted <- root(mamTrees$masterTree,outgroup=c("Platypus","Wallaby","Tasmanian_devil","Opossum"))
wspmr <- masterrooted$tip.label[masterrooted$edge[,2]]
wmvole <- which(wspmr=="Vole")
wmsquirrel <- which(wspmr=="Squirrel")
colMaster <- c(rep("black",length(masterrooted$edge)))
colMaster[wmvole] <- "blue"
colMaster[wmsquirrel] <- "red"
tb3 <- root(mamTrees$trees$BEND3,outgroup=c("Wallaby","Tasmanian_devil","Opossum"))
wspbr <- tb3$tip.label[tb3$edge[,2]]
wbvole <- which(wspbr=="Vole")
wbsquirrel <- which(wspbr=="Squirrel")
coltb3 <- c(rep("black",length(tb3$edge)))
coltb3[wbvole] <- "blue"
coltb3[wbsquirrel] <- "red"
par(mfrow=c(1,2))
plot(masterrooted, main = "Average tree", edge.col=colMaster, cex=0.8) #plot average tree
plot(tb3, main = "BEND3 tree",edge.col=coltb3, cex=0.8) #plot individual gene tree
par(mfrow=c(1,1))
#Note: The RER plotting function currently bugs out when knitting the markdown, though it works perfectly fine in the console (try it!). I'm looking into this.
plotRers(mamRERs,"BEND3") #plot RERs
masterrooted <- root(mamTrees$masterTree,outgroup=c("Platypus","Wallaby","Tasmanian_devil","Opossum"))
wspmr <- masterrooted$tip.label[masterrooted$edge[,2]]
wmvole <- which(wspmr=="Vole")
wmsquirrel <- which(wspmr=="Squirrel")
colMaster <- c(rep("black",length(masterrooted$edge)))
colMaster[wmvole] <- "blue"
colMaster[wmsquirrel] <- "red"
tb3 <- root(mamTrees$trees$BEND3,outgroup=c("Wallaby","Tasmanian_devil","Opossum"))
wspbr <- tb3$tip.label[tb3$edge[,2]]
wbvole <- which(wspbr=="Vole")
wbsquirrel <- which(wspbr=="Squirrel")
coltb3 <- c(rep("black",length(tb3$edge)))
coltb3[wbvole] <- "blue"
coltb3[wbsquirrel] <- "red"
par(mfrow=c(1,2))
plot(masterrooted, main = "Average tree", edge.col=colMaster, cex=0.8) #plot average tree
plot(tb3, main = "BEND3 tree",edge.col=coltb3, cex=0.8) #plot individual gene tree
par(mfrow=c(1,1))
#Note: The RER plotting function currently bugs out when knitting the markdown, though it works perfectly fine in the console (try it!). I'm looking into this.
plotRers(mamRERlogWs,"BEND3") #plot RERs
warnings()
phenvMarine=tree2Paths(marineb, mamTrees)
marineb
mamTrees$masterTree$tip.label
plot(marineb)
phenvMarine=tree2Paths(marineb, mamTrees)
#library("RERconverge")
#This is a temporary alternative to using library (these are the latest versions of the scripts).
source('../R/enrichmentFuncs.R')
source('../R/plottingFuncs.R')
source('../R/projection_coevo.R')
source('../R/RERfuncs.R')
source('../R/coordsfn.R')
mamTrees=readTrees("../data/mammal62aa_meredplus_wCM.trees", max.read = 200)
mamRERlogW=getAllResiduals(mamTrees,useSpecies=mamTrees$masterTree$tip.label, transform = "log", weighted = T, cutoff=0.001)
mamRERlogWs=scale(mamRERlogW)
masterrooted <- root(mamTrees$masterTree,outgroup=c("Platypus","Wallaby","Tasmanian_devil","Opossum"))
wspmr <- masterrooted$tip.label[masterrooted$edge[,2]]
wmvole <- which(wspmr=="Vole")
wmsquirrel <- which(wspmr=="Squirrel")
colMaster <- c(rep("black",length(masterrooted$edge)))
colMaster[wmvole] <- "blue"
colMaster[wmsquirrel] <- "red"
tb3 <- root(mamTrees$trees$BEND3,outgroup=c("Wallaby","Tasmanian_devil","Opossum"))
wspbr <- tb3$tip.label[tb3$edge[,2]]
wbvole <- which(wspbr=="Vole")
wbsquirrel <- which(wspbr=="Squirrel")
coltb3 <- c(rep("black",length(tb3$edge)))
coltb3[wbvole] <- "blue"
coltb3[wbsquirrel] <- "red"
par(mfrow=c(1,2))
plot(masterrooted, main = "Average tree", edge.col=colMaster, cex=0.8) #plot average tree
plot(tb3, main = "BEND3 tree",edge.col=coltb3, cex=0.8) #plot individual gene tree
par(mfrow=c(1,1))
phenvExample <- foreground2Paths(c("Vole","Squirrel"),mamTrees)
plotRers(mamRERlogWs,"BEND3",phenv=phenvExample) #plot RERs
marineb=read.tree("../data/MarineTreeBinCommonNames.txt")
marinebrooted = root(marineb,outgroup=c("Platypus", "Wallaby","Tasmanian_devil","Opossum"))
marineextantforeground = c("Walrus","Seal","Whale","Dolphin","Manatee")
wmarine <- which(wspmr %in% marineextantforeground)
marineb3rooted <- masterrooted
marineb3rooted$edge.length <- c(rep(0,length(marineb3rooted$edge.length)))
marineb3rooted$edge.length[wmarine] <- 1
par(mfrow=c(1,2))
plot(marinebrooted, main="Trait tree from file (1) or manual selection (2)")
plot(marineb3rooted, main="Trait tree from foreground list (3)")
phenvMarine=tree2Paths(marineb, mamTrees)
marineb$tip.label
marineb$tip.label[which(marineb$tip.label=="Antelope")] <- "Tibetan_antelope"
marineb$tip.label[which(marineb$tip.label=="Macaque")] <- "Crab_eating_macaque"
marineb$tip.label[which(marineb$tip.label=="Whale")] <- "Killer_whale"
marineb$tip.lable[which(marineb$tip.label=="Rhesus")] <- "Rhesus_macaque"
write.tree(marineb,file="../data/MarineTreeBinCommonNames.txt")
marineb=read.tree("../data/MarineTreeBinCommonNames.txt")
marinebrooted = root(marineb,outgroup=c("Platypus", "Wallaby","Tasmanian_devil","Opossum"))
marineextantforeground = c("Walrus","Seal","Whale","Dolphin","Manatee")
wmarine <- which(wspmr %in% marineextantforeground)
marineb3rooted <- masterrooted
marineb3rooted$edge.length <- c(rep(0,length(marineb3rooted$edge.length)))
marineb3rooted$edge.length[wmarine] <- 1
par(mfrow=c(1,2))
plot(marinebrooted, main="Trait tree from file (1) or manual selection (2)")
plot(marineb3rooted, main="Trait tree from foreground list (3)")
phenvMarine=tree2Paths(marineb, mamTrees)
marineb$tip.label
marineb$tip.label[which(marineb$tip.label=="Rhesus")] <- "Rhesus_macaque"
write.tree(marineb,file="../data/MarineTreeBinCommonNames.txt")
marineb=read.tree("../data/MarineTreeBinCommonNames.txt")
marinebrooted = root(marineb,outgroup=c("Platypus", "Wallaby","Tasmanian_devil","Opossum"))
marineextantforeground = c("Walrus","Seal","Whale","Dolphin","Manatee")
wmarine <- which(wspmr %in% marineextantforeground)
marineb3rooted <- masterrooted
marineb3rooted$edge.length <- c(rep(0,length(marineb3rooted$edge.length)))
marineb3rooted$edge.length[wmarine] <- 1
par(mfrow=c(1,2))
plot(marinebrooted, main="Trait tree from file (1) or manual selection (2)")
plot(marineb3rooted, main="Trait tree from foreground list (3)")
phenvMarine=tree2Paths(marineb, mamTrees)
phenvMarine2=foreground2Paths(marineextantforeground, mamTrees)
phenvMarine=tree2Paths(marineb, mamTrees)
phenvMarine2=foreground2Paths(marineextantforeground, mamTrees)
phenvMarine2=foreground2Paths(marineextantforeground, mamTrees)
phenvMarine=tree2Paths(marineb, mamTrees)
unlink('WalkThroughBinaryVignetteWynn_cache', recursive = TRUE)
unlink('WalkThroughBinaryVignetteWynn_cache', recursive = TRUE)
library("RERconverge")
install.packages("RERConverge")
install.packages("RERconverge")
install_github("nclark-lab/RERconverge")
library(devtools)
install_github("nclark-lab/RERconverge")
library("RERconverge")
unlink('WalkThroughBinaryVignetteWynn_cache', recursive = TRUE)
unlink('WalkThroughBinaryVignetteWynn_cache', recursive = TRUE)
